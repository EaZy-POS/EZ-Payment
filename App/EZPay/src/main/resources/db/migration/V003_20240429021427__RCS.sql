-- Script generated by Redgate Compare v1.19.7.21820


-- deployment: Creating v_summary_transaction_today...
CREATE VIEW v_summary_transaction_today AS select 'Voucher' AS `module`,ifnull(`v_all_summary_daily`.`transaction_date`,curdate()) AS `transaction_date`,ifnull(sum(`v_all_summary_daily`.`total_transaction`),0) AS `total_transaction`,ifnull(sum(`v_all_summary_daily`.`total_amount`),0) AS `total_amount` from `v_all_summary_daily` where ((`v_all_summary_daily`.`module` = 'VOUCHER') and (`v_all_summary_daily`.`transaction_date` = curdate())) union select 'PLN Postpaid' AS `module`,ifnull(`v_all_summary_daily`.`transaction_date`,curdate()) AS `transaction_date`,ifnull(sum(`v_all_summary_daily`.`total_transaction`),0) AS `total_transaction`,ifnull(sum(`v_all_summary_daily`.`total_amount`),0) AS `total_amount` from `v_all_summary_daily` where ((`v_all_summary_daily`.`module` = 'POSPAID') and (`v_all_summary_daily`.`transaction_date` = curdate())) union select 'PLN Prepaid' AS `module`,ifnull(`v_all_summary_daily`.`transaction_date`,curdate()) AS `transaction_date`,ifnull(sum(`v_all_summary_daily`.`total_transaction`),0) AS `total_transaction`,ifnull(sum(`v_all_summary_daily`.`total_amount`),0) AS `total_amount` from `v_all_summary_daily` where ((`v_all_summary_daily`.`module` = 'PREPAID') and (`v_all_summary_daily`.`transaction_date` = curdate())) union select 'PDAM' AS `module`,ifnull(`v_all_summary_daily`.`transaction_date`,curdate()) AS `transaction_date`,ifnull(sum(`v_all_summary_daily`.`total_transaction`),0) AS `total_transaction`,ifnull(sum(`v_all_summary_daily`.`total_amount`),0) AS `total_amount` from `v_all_summary_daily` where ((`v_all_summary_daily`.`module` = 'PDAM') and (`v_all_summary_daily`.`transaction_date` = curdate())) union select 'Lainnya' AS `module`,ifnull(`v_all_summary_daily`.`transaction_date`,curdate()) AS `transaction_date`,ifnull(sum(`v_all_summary_daily`.`total_transaction`),0) AS `total_transaction`,ifnull(sum(`v_all_summary_daily`.`total_amount`),0) AS `total_amount` from `v_all_summary_daily` where ((`v_all_summary_daily`.`module` not in ('PDAM','POSPAID','PREPAID','VOUCHER')) and (`v_all_summary_daily`.`transaction_date` = curdate()));


-- deployment: Creating v_summary_sales_curent_month...
CREATE VIEW v_summary_sales_curent_month AS select 'Voucher' AS `module`,date_format(ifnull(`v_all_summary_daily`.`transaction_date`,curdate()),'%d') AS `transaction_date`,ifnull(sum(`v_all_summary_daily`.`total_transaction`),0) AS `total_transaction`,ifnull(sum(`v_all_summary_daily`.`total_amount`),0) AS `total_amount` from `v_all_summary_daily` where ((`v_all_summary_daily`.`module` = 'VOUCHER') and (date_format(`v_all_summary_daily`.`transaction_date`,'%Y-%m') = date_format(curdate(),'%Y-%m'))) group by `v_all_summary_daily`.`transaction_date` union select 'PLN Postpaid' AS `module`,date_format(ifnull(`v_all_summary_daily`.`transaction_date`,curdate()),'%d') AS `transaction_date`,ifnull(sum(`v_all_summary_daily`.`total_transaction`),0) AS `total_transaction`,ifnull(sum(`v_all_summary_daily`.`total_amount`),0) AS `total_amount` from `v_all_summary_daily` where ((`v_all_summary_daily`.`module` = 'POSPAID') and (date_format(`v_all_summary_daily`.`transaction_date`,'%Y-%m') = date_format(curdate(),'%Y-%m'))) group by `v_all_summary_daily`.`transaction_date` union select 'PLN Prepaid' AS `module`,date_format(ifnull(`v_all_summary_daily`.`transaction_date`,curdate()),'%d') AS `transaction_date`,ifnull(sum(`v_all_summary_daily`.`total_transaction`),0) AS `total_transaction`,ifnull(sum(`v_all_summary_daily`.`total_amount`),0) AS `total_amount` from `v_all_summary_daily` where ((`v_all_summary_daily`.`module` = 'PREPAID') and (date_format(`v_all_summary_daily`.`transaction_date`,'%Y-%m') = date_format(curdate(),'%Y-%m'))) group by `v_all_summary_daily`.`transaction_date` union select 'PDAM' AS `module`,date_format(ifnull(`v_all_summary_daily`.`transaction_date`,curdate()),'%d') AS `transaction_date`,ifnull(sum(`v_all_summary_daily`.`total_transaction`),0) AS `total_transaction`,ifnull(sum(`v_all_summary_daily`.`total_amount`),0) AS `total_amount` from `v_all_summary_daily` where ((`v_all_summary_daily`.`module` = 'PDAM') and (date_format(`v_all_summary_daily`.`transaction_date`,'%Y-%m') = date_format(curdate(),'%Y-%m'))) group by `v_all_summary_daily`.`transaction_date` union select 'Lainnya' AS `module`,date_format(ifnull(`v_all_summary_daily`.`transaction_date`,curdate()),'%d') AS `transaction_date`,ifnull(sum(`v_all_summary_daily`.`total_transaction`),0) AS `total_transaction`,ifnull(sum(`v_all_summary_daily`.`total_amount`),0) AS `total_amount` from `v_all_summary_daily` where ((`v_all_summary_daily`.`module` not in ('PDAM','POSPAID','PREPAID','VOUCHER')) and (date_format(`v_all_summary_daily`.`transaction_date`,'%Y-%m') = date_format(curdate(),'%Y-%m'))) group by `v_all_summary_daily`.`transaction_date`;

